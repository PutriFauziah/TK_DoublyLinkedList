#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct Data{
	int qty;
	int price;
	char name[30];
    struct	Data *next, *prev;
};

typedef struct Data *myData;


myData create(char name[], int qty, int price){
	myData newData = (myData)malloc(sizeof(struct Data));
	strcpy(newData->name, name);
	newData->qty = qty;
	newData->price = price;
	newData->next = newData->prev=NULL;
	
	return(newData);
}

myData insert(myData head, char name[], int qty, int price){
    myData newData = create(name, qty, price);
    
	if(head==NULL){
	    head= newData;
		return(head);
	}
	
	struct Data *temp = head;
	struct Data *pretemp;
	
	if(temp->qty<=qty){
	    newData->next=head;
	    head->prev=newData;
	    head=newData;
	}else{
	    while(temp->next!=NULL){
	        if(temp->qty>qty){
	            pretemp=temp;
	            temp=temp->next;
	        }else{
	            break;
	        }
	    }
	    
	    if(temp->qty>qty){
	        temp->next=newData;
	        newData->prev=temp;
	    }else if(temp->qty<=qty){
	        pretemp->next=newData;
	        newData->next=temp;
	        temp->prev=newData;
	        newData->prev=pretemp;
	    }
	}
	
	return(head);
}

myData removeData(myData head, char name[]){
    myData temp = head;
    
    if(temp==NULL){
		printf("No Data\n");
		return(head);
	}
	
	if(temp->name == name){
	    if(head->next == NULL){
	        head=NULL;
	        return(head);
	    }
	    
		head=head->next;
		temp->next=NULL;
		temp->prev=NULL;
		free(temp);
		
	}else{
	    while(temp->name >name){
	        if(temp->next != NULL){
	            temp = temp->next;
	        }else{
	            break;
	        }
	    }
	    
	    if(temp->name == name){
	        if(temp->next = NULL){
	            myData tail = temp->prev;
	            tail->next = NULL;
	            temp->prev = NULL;
	            free(temp);
	        }
	    }else{
	        temp->prev->next = temp->next;
	        temp->next->prev = temp->prev;
	        temp->prev = NULL;
	        temp->next = NULL;
	        free(temp);
	    }
	}
	return(head);
}

void printAll(myData head){
	myData md = head;
	printf("\n===Data Barang===\n");
	while(md!=NULL){
		printf("Nama Barang : %s | Jumlah Barang : %d | Harga per Item : %d \n", md->name, md->qty, md->price);
		md=md->next;
	}
	printf("\n");

}

void main(){
    
    int choice = 0;
    char name[30];
    int qty;
    int price;
    myData head = NULL;
    
    do{
        printf("\n== Data Barang Toko Pak Andi ==\n");
        printf("1. Input Data Barang\n");
        printf("2. Hapus Data Barang\n");
        printf("3. Lihat Data Barang\n");
        printf("4. Keluar\n");
    
        do{
            printf("Pilihan Anda  : ");
            scanf("%d", &choice);
            printf("=======================\n");
        } while(choice<1 || choice>4);
        
        switch(choice){
            case 1:
                printf("Nama Barang : ");
                scanf("%s", name);
                printf("Jumlah Barang : ");
                scanf("%d", &qty);
                printf("Harga per Item : ");
                scanf("%d", &price);
                
                head = insert(head, name, qty, price);
                
                break;
                
            case 2:
                printf("Nama Barang yang akan Dihapus : ");
                scanf("%s", name);
                
                head = removeData(head, name);
                
                printAll(head);
                 
                break;
            
            case 3:
                printAll(head);
            
        }
    }while (choice != 4);

	getchar();
}
